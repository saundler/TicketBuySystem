# Микросервисы Авторизации и Покупки Билетов

Этот проект состоит из двух микросервисов:

1. **Микросервис Авторизации**: Обрабатывает регистрацию пользователей, аутентификацию и получение информации о пользователе, используя JWT токены и Spring Security.
2. **Микросервис Покупки Билетов**: Управляет покупкой и выдачей информации о билетах, обеспечивая доступ к информации о билете только его владельцу.

Оба сервиса общаются друг с другом через REST API и имеют свои отдельные базы данных PostgreSQL, которые управляются с помощью Liquibase для миграций базы данных. Проект следует слоистой архитектуре, соблюдая принципы Dependency Injection, SOLID и KISS.

## Предварительные требования

- Docker
- Docker Compose
- Java 21

## Начало работы

### Сборка и запуск проекта

1. **Клонируйте репозиторий**:
    
    bash
    
    Копировать код
    
    `git clone <repository-url> cd <repository-directory>`
    
2. **Соберите и запустите проект**:
    
    bash
    
    Копировать код
    
    `docker-compose build docker-compose up`
    

### Ссылки на Swagger UI

- **Микросервис Авторизации**: [http://localhost:8081/swagger-ui/index.html](http://localhost:8081/swagger-ui/index.html)
- **Микросервис Покупки Билетов**: [http://localhost:8082/swagger-ui/index.html](http://localhost:8082/swagger-ui/index.html)

## Описание микросервисов

### Микросервис Авторизации
Иползует в качестве токена JWT, для более удобной работы без необходимости создания сессий.
Этот сервис реализует три эндпоинта:

1. **Регистрация** (`/register`): Пользователь вводит логин, почту и пароль. Система добавляет его в базу данных и выдает токен в ответе.
2. **Авторизация** (`/login`): Пользователь вводит логин и пароль. Система проверяет данные и выдает токен.
3. **Информация о пользователе** (`/userinfo`): Возвращает данные о пользователе, принимая на вход токен.

### Микросервис Покупки Билетов

Этот сервис реализует три эндпоинта:

1. **Купить билет** (`/buy-ticket`): Пользователь вводит начальную и конечную станции. Система создает билет, сохраняет его в базе данных и возвращает номер билета в ответе.
2. **Информация о билете** (`/ticket-info`): Принимает на вход номер билета и возвращает информацию о нем. Если билет зарегистрирован на другого пользователя, доступ будет запрещен.

## Контейнеризация

Оба микросервиса имеют отдельные Dockerfile и общий `docker-compose.yml`, чтобы собрать и запустить их в контейнерах.

## Использование Swagger

Для документирования и тестирования API используется Swagger. Вы можете получить доступ к Swagger UI по следующим ссылкам:

- **Микросервис Авторизации**: [http://localhost:8081/swagger-ui/index.html](http://localhost:8081/swagger-ui/index.html)
- **Микросервис Покупки Билетов**: [http://localhost:8082/swagger-ui/index.html](http://localhost:8082/swagger-ui/index.html)

